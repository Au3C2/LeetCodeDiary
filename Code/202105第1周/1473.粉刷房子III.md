<!--
 * @Description: 
 * @Autor: Au3C2
 * @Date: 2021-05-04 10:29:18
 * @LastEditors: Au3C2
 * @LastEditTime: 2021-05-04 10:31:11
-->
```python
class Entry:
    def __init__(self):
        self.first = float("inf")
        self.first_idx = -1
        self.second = float("inf")

class Solution:
    def minCost(self, houses: List[int], cost: List[List[int]], m: int, n: int, target: int) -> int:
        # å°†é¢œè‰²è°ƒæ•´ä¸ºä»Ž 0 å¼€å§‹ç¼–å·ï¼Œæ²¡æœ‰è¢«æ¶‚è‰²æ ‡è®°ä¸º -1
        houses = [c - 1 for c in houses]

        # dp æ‰€æœ‰å…ƒç´ åˆå§‹åŒ–ä¸ºæžå¤§å€¼
        dp = [[[float("inf")] * target for _ in range(n)] for _ in range(m)]
        best = [[Entry() for _ in range(target)] for _ in range(m)]

        for i in range(m):
            for j in range(n):
                if houses[i] != -1 and houses[i] != j:
                    continue
                
                for k in range(target):
                    if i == 0:
                        if k == 0:
                            dp[i][j][k] = 0
                    else:
                        dp[i][j][k] = dp[i - 1][j][k]
                        if k > 0:
                            # ä½¿ç”¨ best(i-1,k-1) ç›´æŽ¥å¾—åˆ° dp(i,j,k) çš„å€¼
                            info = best[i - 1][k - 1]
                            dp[i][j][k] = min(dp[i][j][k], (info.second if j == info.first_idx else info.first))

                    if dp[i][j][k] != float("inf") and houses[i] == -1:
                        dp[i][j][k] += cost[i][j]
                    
                    # ç”¨ dp(i,j,k) æ›´æ–° best(i,k)
                    info = best[i][k]
                    if dp[i][j][k] < info.first:
                        info.second = info.first
                        info.first = dp[i][j][k]
                        info.first_idx = j
                    elif dp[i][j][k] < info.second:
                        info.second = dp[i][j][k]

        ans = min(dp[m - 1][j][target - 1] for j in range(n))
        return -1 if ans == float("inf") else ans
```
åŠ¨æ€è§„åˆ’ å›°éš¾ æ¯æ—¥ä¸€é¢˜

é¢˜ç›®éƒ½æ²¡çœ‹å®Œï¼Œæžœæ–­cv

https://leetcode-cn.com/problems/paint-house-iii/comments/

ðŸ‘‡æˆ–è€…è®°å¿†åŒ–é€’å½’
```python
class Solution:
    def minCost(self, houses: List[int], cost: List[List[int]], m: int, n: int, target: int) -> int:

        @lru_cache(None)
        def dfs(i, target, color):
            if target == 0 and i == m:
                return 0
            if target == -1 or i == m:
                return float("inf")

            if houses[i] != 0:
                return dfs(i+1, target if houses[i]==color else target-1, houses[i])
            else:
                return min(dfs(i+1, target if j+1==color else target-1, j+1) + cost[i][j] for j in range(n))

        ans = dfs(0, target, -1)
        return ans if ans != float("inf") else -1
```